var t={134:t=>{t.exports=class{constructor(t,e,i,n){this.conditionalExpression=t,this.dataExpression=e,this.handlingExpression=i||"defaultTemplate",this.tripartite=n}}},824:t=>{t.exports=function(t,e){if(!t)return e;if(!e)return e;if(0!=e.indexOf("../")&&0!=e.indexOf("./"))return e;for(var i=t.split("/"),n=e.split("/");i.length&&!i[0];)i.shift();for(;n.length&&!n[0];)n.shift();if(0==e.indexOf("../")){for(;n.length&&".."==n[0];)i.pop(),n.shift();for(i.pop();n.length;)i.push(n.shift());return i.join("/")}if(0==e.indexOf("./")){for(n.shift(),i.pop();n.length;)i.push(n.shift());return i.join("/")}return e}},668:(t,e,i)=>{const n=i(502);let s=new Function("additionalContexts","with ({\n\t\t'$globals': additionalContexts.globalData\n\t}) {\n\t\twith (additionalContexts.dataFunctions) {\n\t\t\twith (additionalContexts.context) {\n\t\t\t\ttry {\n\t\t\t\t\treturn eval(additionalContexts.expression);\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}");function a(t,e,i,n){return i=i||{},n=n||{},s.call(this,{globalData:n,dataFunctions:i,context:t,expression:e})}t.exports=function(t,e,i,s){if(!e)return null;if("string"==typeof e&&(e=e.trim()),"$this"===e||"this"===e)return t;if("object"==typeof t&&e in t)return t[e];if('""'===e||"''"===e)return"";let r=n(t,e);return null==r&&(r=n({$globals:s},e)),null==r&&(r=a.call(t,t,e,i,s)),r}},268:(t,e,i)=>{let n=i(134);var s=i(824);let a=i(668);t.exports=class{constructor(t,e,i={},n="",s={}){this.tripartite=t,this.template=e,this.destination=n,this.initialData=i,this.currentData=[],this.dataFunctions=s,this.continueOnTripartiteError=!0}run(t){let e;return t&&(e=()=>{t(null,this.destination)}),this._run(this.template,this.initialData,e),this.destination}_resolveHandlingExpression(t,e,i){return e||(e=defaultTemplateName),"$"==e.charAt(0)&&(e=a(i,e.substring(1),this.dataFunctions,this.initialData)),0!=e.indexOf("./")&&0!=e.indexOf("../")||(e=s(t.templateMeta.name,e)),e}_run(t,e,i){let s=[...t.parts].reverse();const r=()=>{if(s.length>0){let o=s.pop();if("string"==typeof o)this.output(o),r();else if(o instanceof n){let n,s=o.conditionalExpression||o.dataExpression,l=!1;if(null==s||null==s||""===s?l=!0:o.conditionalExpression?a(e,o.conditionalExpression,this.dataFunctions,this.initialData)&&(l=!0):(n=a(e,o.dataExpression,this.dataFunctions,this.initialData),null==n?l=!1:("number"==typeof n||Array.isArray(n)&&n.length>0||n)&&(l=!0)),l){o.dataExpression&&void 0===n&&(n=a(e,o.dataExpression,this.dataFunctions,this.initialData)),null==n&&(n=e);let s,l=this._resolveHandlingExpression(t,o.handlingExpression,e),c=(Array.isArray(n)?[...n]:[n]).reverse();const p=()=>{if(c.length>0){let t=c.pop();this._run(s,t,(()=>{p()}))}else r()};l in this.tripartite.templates?(s=this.tripartite.getTemplate(l),s?p():this.continueOnTripartiteError&&r()):this.tripartite.loadTemplate(l,(t=>{if(t)s=t,p();else{let t="Could not load template: "+l;if(console.error(t),this.continueOnTripartiteError)r();else{let e=new Error(t);if(!i)throw e;i(e)}}}))}else r()}else"function"==typeof o&&(o.write?o.write(e,this.destination,(()=>{r()})):(this.output(o(e)),r()))}else i&&i()};r()}output(t){null!=t&&("string"==typeof this.destination?this.destination+=t:this.destination.write&&this.destination.write(t))}}},502:t=>{t.exports=function(t,e){if(null==t)return t;let i;for("string"==typeof e?i=e.trim().split("."):Array.isArray(e)&&(i=e);i.length>0;){let e,n=i.shift();if(n.indexOf(" ")>-1)return null;if("this"===n||"$this"===n?e=t:"object"==typeof t&&n in t&&(e=t[n]),0==i.length)return e;t=e}}},158:(t,e,i)=>{function n(t){return null!==t&&"object"==typeof t&&"function"==typeof t.pipe}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});let s=i(268),a=i(134);class r{constructor(t={}){this.templates={defaultTemplate:this._makeTemplate((function(t){return""+t}))};let{constants:e={templateBoundary:"__",templateNameBoundary:"##"}}=t;this.constants=e,this.secondaryTemplateFunctionObject=t.secondaryTemplateFunctionObject,this.loaders=t.loaders||[],this.dataFunctions=t.dataFunction||{}}_makeTemplate(t){if((e=t)&&"function"==typeof e&&e.write&&e.parts&&e.templateMeta)return t;var e;let i=this,a=function(t){let e=null,i=null,s=null;for(let t=1;t<arguments.length;t++){let a=arguments[t];n(a)?e=a:"function"==typeof a?s=a:"object"==typeof a&&(i=a)}return a.write(t,e,s,i)};return a.write=function(e,n,r,o={}){if(t&&t.write)return t.write.apply(t,arguments);{let t=new s(i,a,e,n||"",i.dataFunctions);return o&&"continueOnTripartiteError"in o&&(t.continueOnTripartiteError=o.continueOnTripartiteError),t.run(r)}},a.parts=[],t&&"function"==typeof t&&a.parts.push(t),a.templateMeta={},a}addTemplate(t,e){return"string"==typeof e?e=this.parseTemplate(e):"function"==typeof e&&(e=this._makeTemplate(e)),this.templates[t]=e,e.templateMeta=e.templateMeta||{},e.templateMeta.name=t,e}createBlank(){return new r}getTemplate(t){return this.templates[t]}loadTemplate(t,e){if(t in this.templates)e(this.templates[t]);else{let i=this,n=this.loaders.length,s=!1;0==n?(i.templates[t]=null,e(i.getTemplate(t))):this.loaders.forEach((a=>{s||a(t,(a=>{s||(n--,a?(s=!0,i.addTemplate(t,a)):0==n&&(s=!0,i.templates[t]=null),s&&e(i.getTemplate(t)))}))}))}}parseTemplateScript(t){for(var e=this.tokenizeTemplateScript(t),i=null,n=0;n<e.length;n++){var s=e[n];if(s.active)i=s.content;else if(i){var a=this.addTemplate(i,this.stripTemplateWhitespace(s.content));this.secondaryTemplateFunctionObject&&(this.secondaryTemplateFunctionObject[i]=a),i=null}}}stripTemplateWhitespace(t){var e=t.indexOf("\n");return e>-1&&""==t.substring(0,e).trim()&&(t=t.substring(e+1)),(e=t.lastIndexOf("\n"))>-1&&""==t.substring(e).trim()&&(t=t.substring(0,e)),t}_createActiveElement(t,e,i,n,s){let r=new a(t,e,i,n);return r.templateMeta=s,r}pt(t){return this.parseTemplate(t)}parseTemplate(t){var e=this.tokenizeTemplate(t);let i=this._makeTemplate();var n=i.templateMeta;for(let t of e)t.active?i.parts.push(this.tokenizeActivePart(t.content,n)):t.content&&i.parts.push(t.content);return i}tokenizeActivePart(t,e){var i=null,n=null,s=null,a=t.indexOf("??");a>-1?(i=t.substring(0,a),a+=2):a=0;var r=t.indexOf("::");return r>-1?(n=t.substring(a,r),s=t.substring(r+2)):n=t.substring(a),this._createActiveElement(i,n,s,this,e)}tokenizeTemplate(t){return this.tokenizeActiveAndInactiveBlocks(t,this.constants.templateBoundary)}tokenizeTemplateScript(t){return this.tokenizeActiveAndInactiveBlocks(t,this.constants.templateNameBoundary)}tokenizeActiveAndInactiveBlocks(t,e){let i=t.length,n=0,s=!1,a=[];for(;n<i;){let o=t.indexOf(e,n);-1==o&&(o=i);var r={active:s,content:t.substring(n,o)};a.push(r),n=o+e.length,s=!s}return a}}var o=new r;"undefined"!=typeof window&&(o.secondaryTemplateFunctionObject=window),t.exports=o,void 0!==i.g&&(i.g.Tripartite||(i.g.Tripartite=r),i.g.tripartite||(i.g.tripartite=o))},705:(t,e,i)=>{var n=i(158);t.exports=n.addTemplate("@webhandle/event-notification-panel/panels/cancel-button",'\t\t<span class="cancel-operation material-icons" title="cancel">\n\t\t\tcancel\n\t\t</span>')},981:(t,e,i)=>{var n=i(158);t.exports=n.addTemplate("@webhandle/event-notification-panel/panels/cancel-mask",'<div class="cancel-mask">\n\tAttempting to Cancel Operation\t\n</div>')},617:(t,e,i)=>{var n=i(158);t.exports=n.addTemplate("@webhandle/event-notification-panel/panels/expand-more",'\t\t<span class="expand-message material-icons" title="view more">\n\t\t\texpand_more\n\t\t</span>')},683:(t,e,i)=>{var n=i(158);t.exports=n.addTemplate("@webhandle/event-notification-panel/panels/message-holder",'\t\t<div class="message-holder">\n\t\t\t<div class="message">\n\t\t\t\t__message__\n\t\t\t</div>\n\t\t</div>')},624:(t,e,i)=>{var n=i(158);t.exports=n.addTemplate("@webhandle/event-notification-panel/panels/notification-top",'\n\t\t<div class="top">\n\t\t\t<span class="icon">\n\t\t\t\t<span class="material-icons">__status::@webhandle/event-notification-panel/utils/iconForStatus__</span>\n\t\t\t</span>\n\t\t\t<span class="headline">\n\t\t\t\t__headline__\n\t\t\t</span>\n\t\t</div>')},309:(t,e,i)=>{var n=i(158);t.exports=n.addTemplate("@webhandle/event-notification-panel/panels/progress-message",'<div class="notification __status__">\n\t<div class="info">\n\t\t__::./notification-top__\n\t\t__message??this::./message-holder__\n\t\t<div class="progress">\n\t\t\t<div class="numeric-holder">\n\t\t\t\t<span class="numeric">__progressComplete__</span>%\n\t\t\t</div>\n\t\t\t<div class="bar">\n\t\t\t\t<div class="made" style="margin-left: __progressComplete__%;"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="actions">\n\t\t<span class="remove-notification material-icons" title="close">\n\t\t\tclose\n\t\t</span>\n\t\t__message??this::./expand-more__\n\t\t__cancelable??this::./cancel-button__\n\t</div>\n</div>')},380:(t,e,i)=>{var n=i(158);t.exports=n.addTemplate("@webhandle/event-notification-panel/panels/simple-message",'<div class="notification __status__">\n\t<div class="info">\n\t\t__::./notification-top__\n\t\t__message??this::./message-holder__\n\t</div>\n\t<div class="actions">\n\t\t<span class="remove-notification material-icons" title="close">\n\t\t\tclose\n\t\t</span>\n\t\t__message??this::./expand-more__\n\t</div>\n</div>')}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,i),a.exports}i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var n={};(()=>{i.d(n,{y_:()=>g,kr:()=>v,P_:()=>y,uy:()=>a,S1:()=>o,Hx:()=>f,cY:()=>_});var t=i(158);let e=!1,s={success:"done",error:"error",warning:"warning",info:"info",waiting:"pending",performing:"swap_horiz",unknown:"question_mark"};function a(){e||(e=!0,t.addTemplate("@webhandle/event-notification-panel/utils/iconForStatus",(t=>t in s?s[t]:t?s.info:t)))}let r=!1;function o(){r||(r=!0,a())}function l([t,e]){let i=(t=t.trim()).split(" "),n=i.shift().trim(),s=i.join(" ").trim();return"string"==typeof e&&(e=e.trim()),{event:n,selector:s,handler:e}}let c={tagName:"div",events:{}};class p{constructor(t){this.id=function(){let t=new Uint8Array(32);window.crypto.getRandomValues(t);let e=btoa(t);return e=e.replace(/\//g,"_").replace(/\+/g,"-").replace(/=+$/,""),e}(),Object.assign(this,c),this.preinitialize.apply(this,arguments),Object.assign(this,t),this._ensureElement(),this.initialize.apply(this,arguments)}preinitialize(){}initialize(){}render(){return this}remove(){this.el.parentElement.removeChild(this.el)}appendTo(t){t.appendChild(this.el)}replaceContentsOf(t){t.innerHTML="",this.appendTo(t)}setElement(t){return this.el!==t&&(this.el=t,this._addListeners()),this}_createElement(t){let e=document.createElement(t);return e.setAttribute("id",this.id),e.view=this,e}_ensureElement(){this.el||this.setElement(this._createElement(this.tagName)),this._setAttributes(),this.className&&this.el.classList.add(this.className)}_setAttributes(t){if(this.attributes)for(let[t,e]of Object.entries(this.attributes))this.el.setAttribute(t,e)}_addListeners(){this.eventTriggers=Object.entries(this.events).map(l);let t=(e=this.eventTriggers,Array.from(e.reduce(((t,e)=>(t.add(e.event),t)),new Set)));var e;for(let e of t)this.el.addEventListener(e,this._eventHandler.bind(this))}_getCandidates(t){return"."===t?[this.el]:Array.from(this.el.querySelectorAll(t))}_eventHandler(t){for(let e of this.eventTriggers)if(t.type==e.event){let i=this._getCandidates(e.selector),n=null;for(let e of i)if(e===t.target||e.contains(t.target)){n=e;break}if(n){"string"==typeof e.handler?this[e.handler].call(this,t,n):"function"==typeof e.handler&&e.handler.call(this,t,n);break}}}}var d=i(380),h=i(309),u=(i(617),i(705),i(981));i(683),i(624);class m extends EventTarget{on(t,e){let i=t=>{e.apply(this,t.detail)};e.nativeListener=i,this.addEventListener(t,i)}emit(t,...e){this.dispatchEvent(new CustomEvent(t,{detail:e}))}removeListener(t,e){e=e.nativeListener||e,this.removeEventListener(t,e)}}const f={SUCCESS:"success",INFO:"info",ERROR:"error",WARNING:"warning",WAITING:"waiting",PERFORMING:"performing",UNKNOWN:"unknown"};o();class v extends p{constructor(t={}){super(t)}preinitialize(){this.events={"click .expand-message":"expandMessage","click .cancel-operation":"cancelOperation","click .remove-notification":"removeSlowly"},this.className="event-notification-view",this.notification=new m,this.notification.on("modelUpdate",this.modelUpdate.bind(this)),this.failToAddTime=1e4}initialize(){this.closed&&this.el.classList.add("closed"),this.notification.emit("initialize",this),this._isComplete()&&this._setupWatchNodeInsertion()}modelUpdate(){this._isProgressType()&&(this.el.querySelector(".made").style.marginLeft=this.model.progressComplete+"%",this.el.querySelector(".numeric").innerText=""+this.model.progressComplete)}_isComplete(){return this.model.status===f.SUCCESS||this.model.status===f.INFO||this.model.status===f.WARNING||this.model.status===f.UNKNOWN||this.model.status===f.ERROR}_isProgressType(){return null!==this.model.progressComplete&&void 0!==this.model.progressComplete}_setupWatchNodeInsertion(){let t=!1;const e=new MutationObserver(((e,i)=>{let n=!1;t:for(let t of e)if("childList"===t.type&&t.addedNodes&&t.addedNodes.length>0)for(let e of t.addedNodes.values())if(e==this.el){n=!0;break t}n&&(i.disconnect(),t=!0,this.notification.emit("nodeAdd",this),this.ttl&&setTimeout((()=>{this.removeSlowly()}),this.ttl))}));e.observe(document.body,{attributes:!1,childList:!0,subtree:!0}),setTimeout((()=>{t||(e.disconnect(),t=!0)}),this.failToAddTime)}render(){let t;return t=this._isProgressType()?h:d,this.el.innerHTML=t(this.model),this.notification.emit("render",this),this}expandMessage(){this.el.classList.remove("closed"),this.notification.emit("expandMessage",this)}cancelOperation(){this.notification.emit("cancel",this),this.el.querySelector(".notification").insertAdjacentHTML("beforeend",u()),this.el.querySelector(".cancel-operation").remove()}remove(){this.el.parentElement&&(this.notification.emit("remove",this),super.remove())}removeSlowly(){this.notification.emit("startRemove",this),addEventListener("transitionend",(t=>{this.remove()})),this.el.style.opacity=0}}class g extends p{constructor(t){super(t)}preinitialize(){this.className="webhandle-event-notifications"}render(){return this}removeAllNotifications(){this.el.innerHTML=""}addNotification(t){let e=new v(t);return e.render(),this.el.insertBefore(e.el,this.el.firstChild),e}}function _({notificationHolder:t="#event-notifications"}={}){let e=window.webhandle=window.webhandle||{};o();let i=document.querySelector(t),n=e.eventPanel=new g;return n.appendTo(i),n.render(),n}class y{constructor(t){Object.assign(this,t)}}})();var s=n.y_,a=n.kr,r=n.P_,o=n.uy,l=n.S1,c=n.Hx,p=n.cY;export{s as EventNotificationPanel,a as EventNotificationView,r as Notification,o as addJsTemplates,l as init,c as notificationStatus,p as setup};
//# sourceMappingURL=event-notification-panel.js.map